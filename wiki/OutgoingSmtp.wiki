#summary Outgoing SMTP specs for ErlMail


= Overview =

The SMTP client that is built into ErlMail is acabale of sending message to antoher SMTP server, so the basic construct of sendingmail is already in place.

The SMTP server is cabable of receiving email for an email address that is listed in the Users and Domains message store, so rhte basic receiving construcuts ar ealready in place.

What needs to be accomplished is building a system where certain computers, either clients or other servers, can send SMTP message to an instace of ErlMail by means of some sort of authentication. Those message would be for users that most likely are not in the Users or Domain message stores. The two most common forms of authentication woudl be IP address based or user authenticaiton based; initally IP address based authenticaiotn will be used.

Once those messages are received they will need to be forwarded to a different SMTP server. In the mean time they will be stores in the Message store and have some META data attached to them. Most notably they will track the number of tries and the time of the most recent try.

A server process will be to be run to find out when message need to be sent or retried. This will most likley be called the SMTP queue and it will be run as a process under the SMTP supervisor. The process will be notified of a new message and it will retry immediately, Otherwise it will retry messages every X minutes.

A lock will need to be placed on a message as it is being sent by a sending process. This is to prevent another sending process on a differnet server from trying to send the same message. This will be crucial in a distributed enviroment with multiple outgoing SMTP servers.

The message name in teh message store will be {MessagName,outgoing_smtp,#outgoing_smtp{}}. This follows the tuple with three elements for the name of the messages in the rest of the message store, it also allows for a unique atom of outgoing_smtp to easily find the messages in the message store and it has a way to keep informationa bout the last attempt, number of tries or any other infomration about the outgoing smtp process. 